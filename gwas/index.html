<html>
<head>
	<title>Chromo</title>
	<link href='https://fonts.googleapis.com/css?family=Roboto:300,100' rel='stylesheet' type='text/css'>
	<meta charset="UTF-8"/>
	<style>
	* {
		font-family: 'Roboto', sans-serif;
	}	
	html,body {
		width:100%;
		height:100%;
		margin:0px;
		padding:0px;
	}
	text {
		font-size: 5px;
	}
	a {
		color:white;
	}
	#link {
		border:thin solid white;
		border-radius:5px;
		padding:5px;
		text-decoration:none;
	}
	.rs:hover {
		r:4;
	}
	#info {
		display:none;
		position:absolute;
		padding:20px;
		border:thin solid #eee;
		background:rgba(0,0,0,0.6);
		color:white;
	}
	svg {
		width:100%;
	}
	.c1 {
		margin-top:2rem;
	}
	.c2 {
		vertical-align:middle;
		font-size:1.5rem;
		color:#777;
		margin-right:2rem;
	}
	</style>
</head>

<body>

<div style="display:flex;justify-content:center">
	<div id="content" style="flex:0 1 800px">
		<h1>
		Genome-wide analyses of empathy and systemizing:<br/>
		heritability and correlates with sex, education, and psychiatric risk
		</h1>
		
		<p style="text-align:justify">
		Empathy is the drive to identify the mental states of others and respond to these
		with an appropriate emotion. Systemizing is the drive to analyse or build lawful
		systems. Difficulties in empathy have been identified in different psychiatric
		conditions including autism and schizophrenia. In this study, we conducted
		genome-wide association studies of empathy and systemizing using the Empathy
		Quotient (EQ) (n = 46,861) and the Systemizing Quotient-Revised (SQ-R)
		(n = 51,564) in participants from 23andMe, Inc. We confirmed significant
		sex-differences in performance on both tasks, with a male advantage on the SQ-R
		and female advantage on the EQ. We found highly significant heritability
		explained by single nucleotide polymorphisms (SNPs) for both the traits
		(EQ: 0.11±0.014; P= 1.7x10-14 and SQ-R: 0.12 ±0.012; P=1.2x10-20) and these were
		similar for males and females. However, genes with higher expression in the male
		brain appear to contribute to the male advantage for the SQ-R. Finally, we
		identified significant genetic correlations between high score for empathy and
		risk for schizophrenia (P= 2.5x10-5), and correlations between high score for
		systemizing and higher educational attainment (P= 5x10-4). These results shed
		light on the genetic contribution to individual differences in empathy and
		systemizing, two major cognitive functions of the human brain.
		</p>
		
		<div class="c1"><span class="c2"> chromosome 1</span> <svg id="chr1"></svg></div>
		<div class="c1"><span class="c2"> chromosome 2</span> <svg id="chr2"></svg></div>
		<div class="c1"><span class="c2"> chromosome 3</span> <svg id="chr3"></svg></div>
		<div class="c1"><span class="c2"> chromosome 4</span> <svg id="chr4"></svg></div>
		<div class="c1"><span class="c2"> chromosome 5</span> <svg id="chr5"></svg></div>
		<div class="c1"><span class="c2"> chromosome 6</span> <svg id="chr6"></svg></div>
		<div class="c1"><span class="c2"> chromosome 7</span> <svg id="chr7"></svg></div>
		<div class="c1"><span class="c2"> chromosome 8</span> <svg id="chr8"></svg></div>
		<div class="c1"><span class="c2"> chromosome 9</span> <svg id="chr9"></svg></div>
		<div class="c1"><span class="c2"> chromosome 10</span> <svg id="chr10"></svg></div>
		<div class="c1"><span class="c2"> chromosome 11</span> <svg id="chr11"></svg></div>
		<div class="c1"><span class="c2"> chromosome 12</span> <svg id="chr12"></svg></div>
		<div class="c1"><span class="c2"> chromosome 13</span> <svg id="chr13"></svg></div>
		<div class="c1"><span class="c2"> chromosome 14</span> <svg id="chr14"></svg></div>
		<div class="c1"><span class="c2"> chromosome 15</span> <svg id="chr15"></svg></div>
		<div class="c1"><span class="c2"> chromosome 16</span> <svg id="chr16"></svg></div>
		<div class="c1"><span class="c2"> chromosome 17</span> <svg id="chr17"></svg></div>
		<div class="c1"><span class="c2"> chromosome 18</span> <svg id="chr18"></svg></div>
		<div class="c1"><span class="c2"> chromosome 19</span> <svg id="chr19"></svg></div>
		<div class="c1"><span class="c2"> chromosome 20</span> <svg id="chr20"></svg></div>
		<div class="c1"><span class="c2"> chromosome 21</span> <svg id="chr21"></svg></div>
		<div class="c1"><span class="c2"> chromosome 22</span> <svg id="chr22"></svg></div>
		<div class="c1"><span class="c2"> chromosome X</span> <svg id="chrX"></svg></div>
		<div class="c1"><span class="c2"> chromosome Y</span> <svg id="chrY"></svg></div>
	</div>
</div>

<div id="info">
	<div style="inline-block">
		<p id="rs"></p>
		<p id="bp"></p>
		<p id="p"></p>
		<p id="rank"></p>
		<div style="text-align:center">
			<a id="link">View on Genome Browser</a>
		</div>
	</div>
</div>

<script type="text/javascript" src="js/lib/jquery-2.0.2.min.js"></script>
<script type="text/javascript" src="js/lib/pako/pako_inflate.min.js"></script>
<script>
var nchr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,"X","Y"];
var i;
var rs;
var	pmin=-1,pmax;
var oy=50;
var h=5;

var G={
	chr1:[	72.562,0xE3,76.781,0x8E,82.688,0xE3,86.062,0x8E,89.438,0xE3,96.188,0x55,102.938,0xE3,110.531,0x8E,117.281,0xE3,124.875,0x8E,129.094,0xE3,133.312,0x8E,137.531,0xE3,146.812,0x8E,155.25 ,0xE3,159.469,0x39,168.75 ,0xE3,178.031,0x55,183.094,0xE3,186.469,0x55,201.656,0xE3,203.344,0x00,231.188,0xE3,237.938,0x39,245.531,0xE3,249.75 ,0x39,259.031,0xE3,264.094,0x00,273.375,0xE3,281.812,0x55,290.25 ,0xE3,293.625,0x55,298.688,0xE3,299.531,0xFF,306.281,0xFF,313.031,0x00,340.031,0xE3,350.156,0x55,353.531,0xE3,360.281,0x55,362.812,0xE3,367.875,0x55,370.406,0xE3,379.688,0x55,383.062,0xE3,389.812,0x39,394.031,0xE3,399.938,0x55,407.531,0xE3,417.656,0x00,426.938,0xE3,432.844,0x00,442.969,0xE3,458.156,0x8E,465.75 ,0xE3,470.812,0x00,489.375,0xE3,490.219,0x8E,495.281,0xE3,502.031,0x55,509.625,0xE3,513.000,0x39,526.500,0xE3,536.625,0x00],
	chr2:[	67.500,0xE3,75.938,0x55,81.000,0xE3,91.969,0x39,100.406,0xE3,104.625,0x39,113.906,0xE3,120.656,0x8E,124.875,0xE3,129.094,0x39,137.531,0xE3,141.750,0x55,147.656,0xE3,159.469,0x00,169.594,0xE3,172.969,0x00,185.625,0xE3,190.688,0x55,203.344,0xE3,207.562,0x55,210.094,0xE3,213.469,0x00,229.500,0xE3,243.000,0xFF,248.062,0xFF,252.281,0xE3,264.938,0x55,270.844,0xE3,273.375,0x8E,277.594,0xE3,286.875,0x55,296.156,0xE3,302.906,0x55,318.094,0xE3,323.156,0x8E,327.375,0xE3,331.594,0x00,342.562,0xE3,346.781,0x00,354.375,0xE3,356.062,0x8E,357.750,0xE3,366.188,0x39,375.469,0xE3,383.062,0x39,394.875,0xE3,410.906,0x55,415.969,0xE3,420.188,0x39,432.844,0xE3,437.062,0x39,448.031,0xE3,460.688,0x55,464.906,0xE3,471.656,0x00,482.625,0xE3,494.438,0x39,502.031,0xE3,503.719,0x00,513.000,0xE3,521.438,0x55,524.812,0xE3,536.625,0x00],
	chr3:[	67.500,0x55,75.938,0xE3,80.156,0x55,87.750,0xE3,94.500,0x8E,97.031,0xE3,102.094,0x00,123.188,0xE3,129.938,0x39,140.062,0xE3,142.594,0x55,153.562,0xE3,160.312,0x39,170.438,0xE3,172.125,0x55,172.969,0xE3,188.156,0x8E,189.000,0xE3,195.750,0x55,205.031,0xE3,217.688,0x55,236.250,0xE3,242.156,0x39,259.875,0xE3,264.094,0x39,272.531,0xE3,277.594,0xFF,283.500,0xFF,286.875,0x00,302.062,0xE3,306.281,0x8E,308.812,0xE3,313.031,0x39,320.625,0xE3,324.844,0x55,332.438,0xE3,337.500,0x39,346.781,0xE3,351.000,0x39,357.750,0xE3,361.969,0x8E,367.875,0xE3,376.312,0x8E,386.438,0xE3,390.656,0x8E,397.406,0xE3,406.688,0x00,421.031,0xE3,428.625,0x55,435.375,0xE3,439.594,0x55,443.812,0xE3,446.344,0x00,465.750,0xE3,473.344,0x39,484.312,0xE3,491.906,0x39,500.344,0xE3,504.562,0x8E,508.781,0xE3,513.000,0x39,523.125,0xE3,536.625,0x00],
	chr4:[	67.500,0xE3,75.094,0x8E,80.156,0xE3,94.500,0x55,104.625,0xE3,113.062,0x39,124.031,0xE3,135.844,0x00,154.406,0xE3,167.906,0x55,179.719,0xE3,187.312,0xFF,191.531,0xFF,195.750,0xE3,212.625,0x00,230.344,0xE3,240.469,0x39,254.812,0xE3,261.562,0x55,270.000,0xE3,274.219,0x8E,280.969,0xE3,283.500,0x39,297.844,0xE3,301.219,0x39,310.500,0xE3,318.938,0x55,332.438,0xE3,347.625,0x39,363.656,0xE3,371.250,0x55,383.906,0xE3,389.812,0x00,410.062,0xE3,415.125,0x8E,422.719,0xE3,429.469,0x8E,437.906,0xE3,448.031,0x00,463.219,0xE3,470.812,0x00,485.156,0xE3,490.219,0x39,500.344,0xE3,503.719,0x00,515.531,0xE3,526.500,0x8E,536.625,0x00],
	chr5:[	72.562,0xE3,83.531,0x8E,87.75,0xE3,93.656,0x55,111.375,0xE3,119.812,0x00,132.469,0xE3,135.844,0x00,147.656,0xE3,161.156,0x8E,171.281,0xE3,181.406,0x55,189.844,0xFF,194.906,0xFF,202.5,0xE3,223.594,0x39,234.562,0xE3,236.25,0x39,243,0xE3,248.062,0x55,260.719,0xE3,268.312,0x55,280.969,0xE3,285.188,0x00,307.969,0xE3,322.312,0x00,336.656,0xE3,340.875,0x00,353.531,0xE3,358.594,0x55,362.812,0xE3,367.875,0x00,383.906,0xE3,399.094,0x00,407.531,0xE3,420.188,0x8E,429.469,0xE3,439.594,0x39,450.562,0xE3,463.219,0x55,471.656,0xE3,482.625,0x00,502.031,0xE3,514.688,0x8E,525.656,0xE3,536.625,0x00],
	chr6:[	67.5,0xE3,73.406,0x8E,78.469,0xE3,86.906,0x55,96.188,0xE3,97.875,0x8E,104.625,0xE3,109.688,0x39,131.625,0xE3,139.219,0x55,149.344,0xE3,155.25,0x8E,159.469,0xE3,168.75,0x8E,178.875,0xE3,191.531,0x00,207.562,0xE3,211.781,0x00,224.438,0xE3,227.812,0xFF,233.719,0xFF,241.312,0xE3,242.156,0x00,259.875,0xE3,275.906,0x55,297.844,0xE3,300.375,0x55,307.969,0xE3,320.625,0x00,338.344,0xE3,341.719,0x00,355.219,0xE3,380.531,0x39,388.969,0xE3,393.188,0x00,414.281,0xE3,416.812,0x39,425.25,0xE3,427.781,0x55,438.75,0xE3,449.719,0x39,459.844,0xE3,467.438,0x39,476.719,0xE3,486,0x55,494.438,0xE3,508.781,0x55,518.906,0xE3,536.625,0x00],
	chr7:[	67.5,0xE3,73.406,0x8E,81,0xE3,88.594,0x00,107.156,0xE3,112.219,0x00,124.875,0xE3,140.906,0x55,150.188,0xE3,161.156,0x39,172.969,0xE3,178.031,0x39,195.75,0xE3,205.031,0x39,214.312,0xE3,217.688,0x39,226.969,0xE3,237.094,0xFF,242.156,0xFF,248.062,0xE3,262.406,0x55,279.281,0xE3,296.156,0x00,322.312,0xE3,327.375,0x39,335.812,0xE3,340.875,0x39,356.906,0xE3,375.469,0x55,380.531,0xE3,383.906,0x39,405,0xE3,413.438,0x39,424.406,0xE3,432.844,0x39,442.125,0xE3,448.875,0x8E,451.406,0xE3,459,0x55,473.344,0xE3,489.375,0x39,502.875,0xE3,517.219,0x8E,524.812,0xE3,536.625,0x00],
	chr8:[	67.5,0xE3,74.25,0x39,87.75,0xE3,108,0x00,129.094,0xE3,142.594,0x55,155.25,0xE3,162.844,0x39,190.688,0xE3,194.062,0x8E,195.75,0xE3,205.875,0xFF,212.625,0xFF,221.906,0xE3,229.5,0x39,237.094,0xE3,245.531,0x55,265.781,0xE3,267.469,0x55,279.281,0xE3,286.031,0x55,293.625,0xE3,304.594,0x00,318.938,0xE3,324.844,0x39,340.031,0xE3,346.781,0x00,367.031,0xE3,385.594,0x8E,393.188,0xE3,407.531,0x39,421.875,0xE3,426.938,0x00,444.656,0xE3,449.719,0x55,460.688,0xE3,475.875,0x55,489.375,0xE3,505.406,0x39,516.375,0xE3,536.625,0x00],
	chr9:[	67.5,0xE3,75.094,0x8E,82.688,0xE3,97.875,0x39,114.75,0xE3,123.188,0x8E,129.094,0xE3,134.156,0x00,152.719,0xE3,161.156,0x00,177.188,0xE3,189,0x8E,194.906,0xE3,201.656,0x55,209.25,0xE3,223.594,0xFF,240.469,0xFF,269.156,0x00,301.219,0xE3,302.906,0x8E,310.5,0xE3,312.188,0x55,332.438,0xE3,335.812,0x55,346.781,0xE3,355.219,0x55,367.031,0xE3,372.094,0x8E,378.844,0xE3,387.281,0x8E,395.719,0xE3,407.531,0x00,426.094,0xE3,436.219,0x8E,448.031,0xE3,458.156,0x39,475.875,0xE3,488.531,0x8E,500.344,0xE3,510.469,0x8E,511.312,0xE3,518.906,0x8E,523.969,0xE3,536.625,0x00],
	chr10:[	72.562,0xE3,82.688,0x8E,85.219,0xE3,95.344,0x39,114.75,0xE3,131.625,0x39,140.906,0xE3,142.594,0x39,151.031,0xE3,155.25,0x55,169.594,0xE3,180.562,0x8E,190.688,0xE3,205.875,0xFF,210.938,0xFF,216.844,0xE3,230.344,0x8E,244.688,0xE3,255.656,0x00,282.656,0xE3,294.469,0x00,317.25,0xE3,328.219,0x55,337.5,0xE3,353.531,0x00,373.781,0xE3,379.688,0x39,390.656,0xE3,395.719,0x55,408.375,0xE3,413.438,0x55,421.875,0xE3,425.25,0x8E,432,0xE3,434.531,0x00,455.625,0xE3,466.594,0x39,480.938,0xE3,489.375,0x55,494.438,0xE3,509.625,0x55,519.75,0xE3,536.625,0x00],
	chr11:[	72.562,0xE3,81.844,0x55,109.688,0xE3,116.438,0x55,128.25,0xE3,146.812,0x00,162,0xE3,166.219,0x39,179.719,0xE3,198.281,0x00,222.75,0xE3,241.312,0x39,249.75,0xFF,254.812,0xFF,267.469,0x39,278.438,0xE3,284.344,0x8E,290.25,0xE3,303.75,0x8E,311.344,0xE3,316.406,0x55,330.75,0xE3,337.5,0x00,367.031,0xE3,376.312,0x00,391.5,0xE3,406.688,0x00,423.562,0xE3,426.094,0x00,452.25,0xE3,461.531,0x55,470.812,0xE3,489.375,0x55,498.656,0xE3,512.156,0x55,522.281,0xE3,536.625,0x00],
	chr12:[	77.625,0xE3,88.594,0x8E,96.188,0xE3,112.219,0x39,121.5,0xE3,129.094,0x00,146.812,0xE3,151.031,0x00,168.75,0xE3,173.812,0x55,183.938,0xE3,192.375,0xFF,200.812,0xFF,204.188,0x00,232.031,0xE3,242.156,0x8E,245.531,0xE3,261.562,0x8E,269.156,0xE3,272.531,0x39,290.25,0xE3,297.844,0x55,306.281,0xE3,319.781,0x39,334.969,0xE3,350.156,0x00,372.938,0xE3,381.375,0x00,394.031,0xE3,406.688,0x39,424.406,0xE3,432.844,0x55,450.562,0xE3,459.844,0x8E,461.531,0xE3,469.125,0x55,477.562,0xE3,482.625,0x55,491.062,0xE3,509.625,0x55,523.969,0xE3,536.625,0x00],
	chr13:[	62.438,0x00,78.469,0x7F,97.031,0x00,118.125,0xFF,129.094,0xFF,139.219,0xE3,154.406,0x8E,163.688,0xE3,172.969,0x8E,178.031,0xE3,191.531,0x55,199.125,0xE3,206.719,0x39,226.125,0xE3,246.375,0x8E,253.125,0xE3,253.969,0x55,265.781,0xE3,279.281,0x00,302.062,0xE3,313.875,0x39,329.062,0xE3,341.719,0x00,361.969,0xE3,370.406,0x55,378,0xE3,385.594,0x00,421.875,0xE3,431.156,0x00,452.25,0xE3,465.75,0x8E,469.969,0xE3,480.094,0x00,493.594,0xE3,502.031,0x00,515.531,0xE3,536.625,0x00],
	chr14:[	62.438,0x00,75.938,0x7F,91.969,0x00,123.188,0xFF,131.625,0xFF,147.656,0xE3,167.906,0x00,204.188,0xE3,214.312,0x55,221.062,0xE3,226.969,0x00,245.531,0xE3,254.812,0x00,277.594,0xE3,295.312,0x8E,304.594,0xE3,311.344,0x39,334.969,0xE3,347.625,0x55,361.125,0xE3,371.25,0x55,387.281,0xE3,411.75,0x00,430.312,0xE3,437.062,0x00,459,0xE3,465.75,0x8E,475.875,0xE3,487.688,0x55,509.625,0xE3,518.062,0x55,521.438,0xE3,536.625,0x00],
	chr15:[	62.438,0x00,79.312,0x7F,99.562,0x00,129.094,0xFF,142.594,0xFF,149.344,0xE3,172.969,0x55,183.938,0xE3,194.906,0x55,199.125,0xE3,210.938,0x39,241.312,0xE3,254.812,0x8E,258.188,0xE3,264.094,0x39,287.719,0xE3,303.75,0x39,326.531,0xE3,332.438,0x8E,352.688,0xE3,369.562,0x8E,369.562,0xE3,371.25,0x8E,394.875,0xE3,407.531,0x8E,414.281,0xE3,421.875,0x55,437.906,0xE3,454.781,0x55,473.344,0xE3,497.812,0x55,517.219,0xE3,536.625,0x00],
	chr16:[	72.562,0xE3,105.469,0x55,126.562,0xE3,137.531,0x55,149.344,0xE3,159.469,0x55,179.719,0xE3,185.625,0x55,216.844,0xE3,252.281,0xFF,272.531,0xFF,285.188,0x00,310.5,0xE3,340.031,0x55,356.906,0xE3,368.719,0x00,413.438,0xE3,435.375,0x55,437.062,0xE3,455.625,0x39,480.938,0xE3,492.75,0x55,504.562,0xE3,519.75,0x8E,528.188,0xE3,536.625,0x00],
	chr17:[	72.562,0xE3,93.656,0x55,112.219,0xE3,138.375,0x39,166.219,0xE3,202.5,0xFF,203.344,0xFF,209.25,0xE3,242.156,0x55,280.969,0xE3,282.656,0x8E,295.312,0xE3,319.781,0x8E,336.656,0xE3,352.688,0x39,395.719,0xE3,399.938,0x39,416.812,0xE3,425.25,0x55,435.375,0xE3,453.094,0x39,475.875,0xE3,497.812,0x8E,502.031,0xE3,536.625,0x00],
	chr18:[	77.625,0xE3,95.344,0x55,120.656,0xE3,129.094,0x8E,143.438,0xE3,170.438,0xFF,174.656,0xFF,182.25,0xE3,218.531,0x00,264.938,0xE3,291.938,0x39,329.906,0xE3,357.75,0x39,391.5,0xE3,405.844,0x55,421.875,0xE3,437.906,0x00,469.125,0xE3,480.938,0x8E,507.938,0xE3,536.625,0x00],
	chr19:[	72.562,0xE3,122.344,0x8E,164.531,0xE3,172.969,0x8E,189.844,0xE3,216.844,0x00,266.625,0xFF,280.125,0xFF,291.938,0x00,342.562,0xE3,365.344,0x8E,385.594,0xE3,388.125,0x8E,420.188,0xE3,436.219,0x8E,464.062,0xE3,491.062,0x8E,502.031,0xE3,518.906,0x8E,536.625,0x00],
	chr20:[	62.438,0xE3,100.406,0x39,130.781,0xE3,152.719,0x39,197.438,0xE3,223.594,0x8E,232.031,0xE3,257.344,0xFF,268.312,0xFF,278.438,0xE3,302.062,0x8E,319.781,0xE3,344.25,0x39,374.625,0xE3,378,0x8E,410.062,0xE3,436.219,0x39,475.875,0xE3,486.844,0x55,502.031,0xE3,536.625,0x00],
	chr21:[	62.438,0x00,91.969,0x7F,125.719,0x00,163.688,0xFF,186.469,0xFF,195.75,0xE3,216.844,0x00,293.625,0xE3,323.156,0x39,370.406,0xE3,412.594,0x55,432.844,0xE3,452.25,0x55,480.938,0xE3,536.625,0x00],
	chr22:[	62.438,0x00,91.125,0x7F,125.719,0x00,154.406,0xFF,174.656,0xFF,217.688,0xE3,258.188,0x8E,270.844,0xE3,294.469,0x55,329.062,0xE3,353.531,0x55,405,0xE3,437.062,0x55,469.125,0xE3,511.312,0x55,522.281,0xE3,536.625,0x00],
	chrX:[	72.562,0xE3,85.219,0x55,90.281,0xE3,101.25,0x55,124.031,0xE3,129.938,0x55,137.531,0xE3,146.812,0x00,160.312,0xE3,167.062,0x00,184.781,0xE3,199.125,0x39,214.312,0xE3,221.062,0x8E,236.25,0xE3,242.156,0xFF,250.594,0xFF,267.469,0xE3,267.469,0x55,275.062,0xE3,288.562,0x55,293.625,0xE3,300.375,0x00,325.688,0xE3,330.75,0x00,347.625,0xE3,352.688,0x39,367.031,0xE3,379.688,0x55,383.062,0xE3,403.312,0x39,422.719,0xE3,434.531,0x00,461.531,0xE3,463.219,0x8E,472.5,0xE3,485.156,0x39,491.906,0xE3,497.812,0x00,513,0xE3,536.625,0x00],
	chrY:[	72.562,0xE3,86.062,0x55,98.719,0xE3,162.844,0xFF,163.688,0xFF,172.969,0xE3,187.312,0x55,225.281,0xE3,243.844,0x55,276.75,0xE3,291.094,0x00,536.625,0x00]
};
var chrLength={
	chr1: 249250621,
	chr2: 243199373,
	chr3: 198022430,
	chr4: 191154276,
	chr5: 180915260,
	chr6: 171115067,
	chr7: 159138663,
	chr8: 146364022,
	chr9: 141213431,
	chr10: 135534747,
	chr11: 135006516,
	chr12: 133851895,
	chr13: 115169878,
	chr14: 107349540,
	chr15: 102531392,
	chr16: 90354753,
	chr17: 81195210,
	chr18: 78077248,
	chr19: 59128983,
	chr20: 63025520,
	chr21: 48129895,
	chr22: 51304566,
	chrX: 155270560,
	chrY: 59373566
};

function makeSVG(tag, attrs) {
    var el=document.createElementNS("http://www.w3.org/2000/svg",tag);
    for (var k in attrs)
        el.setAttribute(k, attrs[k]);
    return el;
}
function drawchr(chr) {
	var arr=[];
	var	min,max,w,z;
	var i,c;
	var W;
	
	min=G[chr][0];
	max=G[chr][G[chr].length-2];
	W=parseInt(0.5+max-min);
	
	//$("#"+chr).attr({width:W,height:(oy+h),viewBox:"0 0 "+W+" "+(oy+h)});
	$("#"+chr)[0].setAttribute("viewBox", "-5 0 "+(W+10)+" "+(oy+h));
	
	var gr=makeSVG('path',{
		d:'M0,0h'+W+' M0,10h'+W+' M0,20h'+W+' M0,30h'+W+' M0,40h'+W,
		stroke:"#7f7f7f",
		"stroke-width":0.1
	});
	$("#"+chr).append(gr);
	
	for(i=0;i<5;i++) {
		var tx=makeSVG('text',{x:-5,y:50-i*10,fill:'#7f7f7f',id:chr+"_"+i});
		$("#"+chr).append(tx);
		$("#"+chr+"_"+i).text(i*2);
	}

	c=0;
	for(i=0;i<G[chr].length/2-1;i++)
	{
		w=(G[chr][2*(i+1)]-G[chr][2*i]);
		r=[(G[chr][2*i]-min),oy,w,h];
		co=('00'+G[chr][2*i+1].toString(16)).substr(-2);
		co="#"+co+co+co;
		if(co=="#ffffff" && c==0)
		{
			var re=makeSVG('path',{d:'M'+r[0]+','+r[1]+' L'+(r[0]+r[2])+','+(r[1]+r[3]/2)+' L'+r[0]+','+(r[1]+r[3]),fill:"black"});
			$("#"+chr).append(re);
			c=1;
		}
		else
		if(co=="#ffffff" && c==1)
		{
			var re=makeSVG('path',{d:'M'+r[0]+','+(r[1]+r[3]/2)+' L'+(r[0]+r[2])+','+r[1]+' L'+(r[0]+r[2])+','+(r[1]+r[3]),fill:"black"});
			$("#"+chr).append(re);
			c=2;
		}
		else
		{
			var re=makeSVG('rect',{x:r[0],y:r[1],width:r[2],height:r[3],fill:co});
			$("#"+chr).append(re);
		}
	}
}
function x(i) {
	return ('00'+i.toString(16)).substr(-2);	
}
function color(val) {
	var r,g,b;
	r=val*255;
	g=0;
	b=(1-val)*255;
	return '#'+x(parseInt(r))+x(parseInt(g))+x(parseInt(b));
}

// Draw chromosomes
for(i=0;i<nchr.length;i++)
	drawchr("chr"+nchr[i]);

// Draw allele significance
var xhr = new XMLHttpRequest();
xhr.open('GET', "data/empathy-10k.txt.gz", true);
xhr.responseType = 'arraybuffer';
xhr.onload = function(e) {if (this.status == 200) {

	/*
	var inflate=new pako.Inflate();
	inflate.push(new Uint8Array(this.response),true);
	var data=inflate.result.buffer;
	*/
	var data=pako.inflate(new Uint8Array(this.response),{to:'string'});

	var i;
	rs=data.split("\n");
	for(i=0;i<rs.length;i++) {
		rs[i]=rs[i].split("\t");
		rs[i][2]=parseInt(rs[i][2]);
		rs[i][3]=parseFloat(rs[i][3]);
		if(rs[i][1]=="1") {
			if(pmin==-1) {
				pmin=rs[i][3];
				pmax=rs[i][3];
			}
			if(rs[i][3]<pmin) pmin=rs[i][3];
			if(rs[i][3]>pmax) pmax=rs[i][3];
		}
	}
	
	for(i=rs.length-1;i>=0;i--) {
		if(rs[i][1]) {
			var ch="chr"+rs[i][1];
			var w=(G[ch][G[ch].length-2]-G[ch][0])/chrLength[ch];
			var re=makeSVG('circle',{cx:rs[i][2]*w,cy:oy-rs[i][3]*5,r:3,fill:color((rs[i][3]-pmin)/(pmax-pmin)),"fill-opacity":0.5,id:"rs"+i,class:"rs"});
			$("#"+ch).append(re);
		}
	}

	$(".rs").click(function() {
		var o=$(this).offset();
		$("#info").show();
		$("#info").css({top:o.top,left:o.left});
		var i=$(this).attr('id').split("s")[1];
		$("#info #rs").html("RefSeq: "+rs[i][0]);
		$("#info #bp").html("Base Pair: "+rs[i][2]);
		$("#info #p").html("P-value: 10<sup>-"+rs[i][3]+"</sup>");
		$("#info #rank").html("Rank: "+i);
		$("#link").attr('href',"http://genome-euro.ucsc.edu/cgi-bin/hgTracks?db=hg19&position=chr"+rs[i][1]+"%3A"+(rs[i][2]-1000)+"-"+(rs[i][2]+1000)+"&hgsid=216670668");
	});
	$("#info").mouseleave(function() {
		setTimeout(function(){$("#info").hide();},500);
	});

}};

xhr.send();

/*
$.get("data/empathy-10k.txt.gz",function(zip) {
	var inflate=new pako.Inflate();
	inflate.push(zip,true);
	var data=inflate.result.buffer;

	var i;
	rs=data.split("\n");
	for(i=0;i<rs.length;i++) {
		rs[i]=rs[i].split("\t");
		rs[i][2]=parseInt(rs[i][2]);
		rs[i][3]=parseFloat(rs[i][3]);
		if(rs[i][1]=="1") {
			if(pmin==-1) {
				pmin=rs[i][3];
				pmax=rs[i][3];
			}
			if(rs[i][3]<pmin) pmin=rs[i][3];
			if(rs[i][3]>pmax) pmax=rs[i][3];
		}
	}
	
	for(i=rs.length-1;i>=0;i--) {
		if(rs[i][1]) {
			var ch="chr"+rs[i][1];
			var w=(G[ch][G[ch].length-2]-G[ch][0])/chrLength[ch];
			var re=makeSVG('circle',{cx:rs[i][2]*w,cy:oy-rs[i][3]*5,r:3,fill:color((rs[i][3]-pmin)/(pmax-pmin)),"fill-opacity":0.5,id:"rs"+i,class:"rs"});
			$("#"+ch).append(re);
		}
	}

	$(".rs").click(function() {
		var o=$(this).offset();
		$("#info").show();
		$("#info").css({top:o.top,left:o.left});
		var i=$(this).attr('id').split("s")[1];
		$("#info #rs").html("RefSeq: "+rs[i][0]);
		$("#info #bp").html("Base Pair: "+rs[i][2]);
		$("#info #p").html("P-value: 10<sup>-"+rs[i][3]+"</sup>");
		$("#info #rank").html("Rank: "+i);
		$("#link").attr('href',"http://genome-euro.ucsc.edu/cgi-bin/hgTracks?db=hg19&position=chr"+rs[i][1]+"%3A"+(rs[i][2]-1000)+"-"+(rs[i][2]+1000)+"&hgsid=216670668");
	});
	$("#info").mouseleave(function() {
		setTimeout(function(){$("#info").hide();},500);
	});
});
*/
</script>

</body>
</html>